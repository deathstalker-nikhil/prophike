var backofficeApp=angular.module("backofficeApp","ngRoute backoffice.file_upload backofficeApp.locations backofficeApp.properties backofficeApp.comments backofficeApp.builder backofficeApp.specifications backofficeApp.changePassword builderService commentsService locationsService propertiesService specificationsService unitsService backofficeApp.userQueries userQueriesService".split(" ")).config(["$routeProvider",function(a){a.otherwise({redirectTo:"/locations"})}]);"use strict";
angular.module("backoffice.file_upload",["angularFileUpload"]).config(["$routeProvider",function(a){a.when("/upload/:type/:id",{templateUrl:"backoffice_app/file_upload/fileUploadView.html",controller:"fileUploadCtrl"})}]).controller("fileUploadCtrl",["$scope","FileUploader","$routeParams","properties","builder","specifications","units",function(a,h,f,k,e,c,b){a.type=f.type;a.enableSave=!0;var g={};a.id=f.id;switch(a.type){case "property":a.subTypes=["const_update","thumb","cover","gallery"];a.app.state=
"properties";g.property={const_update:[],cover:[],thumb:[],gallery:[]};k.get({id:a.id,fields:"project_id as id,name,media",get_all_projects:1},function(a,b){angular.equals([],a.data)||a.data[0].media&&(g=angular.fromJson(a.data[0].media))});break;case "specification":a.subTypes=["specification_logo"];a.app.state="specifications";g.logo=[];c.get({id:a.id,fields:"id,name,icon_path"},function(a,b){angular.equals([],a.data)||a.data[0].icon_path&&(g=angular.fromJson(a.data[0].icon_path))});break;case "builder":a.subTypes=
["builder_logo"];a.app.state="builders";g.logo=[];e.get({id:a.id,fields:"id,builder_name,logo_link"},function(a,b){angular.equals([],a.data)||a.data[0].logo_link&&(g=angular.fromJson(a.data[0].logo_link))});break;case "unit":a.subTypes=["unit"],a.app.state="properties",g.img=[],b.get({id:a.id,fields:"id,unit_name,image_path"},function(a,b){angular.equals([],a.data)||a.data[0].image_path&&(g=angular.fromJson(a.data[0].image_path))})}"undefined"==typeof a.subTypes?(alert("Incorrect Url"),window.history.back()):
a.subtype=a.subTypes[0];var d=a.uploader=new h({url:"/file/do_upload"});d.formData.push({type:a.subtype});a.setData=function(){d.formData[0]={type:a.subtype}};d.formData.push({csrf_token:document.cookie.replace(/(?:(?:^|.*;\s*)csrf_cookie\s*\=\s*([^;]*).*$)|^.*$/,"$1")});d.filters.push({name:"imageFilter",fn:function(a,b){var d="|"+a.type.slice(a.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|pdf|".indexOf(d)}});a.goback=function(){switch(a.type){case "property":window.location="/backoffice#/properties/media/"+
a.id;break;case "builder":window.location="/backoffice#/builder/media/"+a.id;break;case "specification":window.location="/backoffice#/specification/media/"+a.id;break;case "unit":window.location="/backoffice#/units/media/"+a.id}};a.saveImages=function(){switch(a.type){case "property":k.update({project_id:a.id,media:angular.toJson(g)},function(b,d){204==d&&(alert("Saved :)"),a.goback())});break;case "builder":e.update({id:a.id,logo_link:angular.toJson(g)},function(b,d){204==d&&(alert("Saved :)"),a.goback())});
break;case "specification":c.update({id:a.id,icon_path:angular.toJson(g)},function(b,d){204==d&&(alert("Saved :)"),a.goback())});break;case "unit":b.update({id:a.id,image_path:angular.toJson(g)},function(b,d){204==d&&(alert("Saved :)"),a.goback())})}};d.onWhenAddingFileFailed=function(a,b,d){alert("adding file failed")};d.onAfterAddingFile=function(a){};d.onAfterAddingAll=function(a){};d.onBeforeUploadItem=function(a){};d.onProgressItem=function(a,b){};d.onProgressAll=function(a){};d.onSuccessItem=
function(b,d,c,e){if(d.error)alert(d.error),b.remove();else switch(a.enableSave=!1,g.type=a.type,d.type){case "const_update":g.property.const_update.push(d.path);break;case "thumb":g.property.thumb.push(d.path);break;case "cover":g.property.cover.push(d.path);break;case "gallery":g.property.gallery.push(d.path);break;case "specification_logo":g.logo.push(d.path);break;case "builder_logo":g.logo.push(d.path);break;case "unit":g.img.push(d.path)}};d.onErrorItem=function(a,b,d,g){403==d&&alert("File not uploaded to server ( can be due to file size too big )")};
d.onCancelItem=function(a,b,d,g){};d.onCompleteItem=function(a,b,d,g){};d.onCompleteAll=function(){}}]);"use strict";
angular.module("backoffice.file_upload").factory("fileService",["$rootScope","$httpParamSerializerJQLike","$http",function(a,h,f){return{delete:function(a,e){var c=document.cookie.replace(/(?:(?:^|.*;\s*)csrf_cookie\s*\=\s*([^;]*).*$)|^.*$/,"$1"),c=h({url:a,csrf_token:c});f.post("/file/delete_file",c,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(a,g,d,c){e(a,g)}).error(function(a,g,d,c){e(a,g)})}}}]);"use strict";
angular.module("backoffice.file_upload").directive("ngThumb",["$window",function(a){var h={support:!(!a.FileReader||!a.CanvasRenderingContext2D),isFile:function(f){return angular.isObject(f)&&f instanceof a.File},isImage:function(a){a="|"+a.type.slice(a.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|pdf|".indexOf(a)}};return{restrict:"A",template:"<canvas/>",link:function(a,k,e){function c(a){var d=new Image;d.onload=b;d.src=a.target.result}function b(){var a=g.width||this.width/this.height*
g.height,b=g.height||this.height/this.width*g.width;d.attr({width:a,height:b});d[0].getContext("2d").drawImage(this,0,0,a,b)}if(h.support){var g=a.$eval(e.ngThumb);if(h.isFile(g.file)&&h.isImage(g.file)){var d=k.find("canvas");a=new FileReader;a.onload=c;a.readAsDataURL(g.file)}}}}}]);"use strict";
angular.module("backofficeApp.locations",["ngRoute","backofficeApp.locations.create","backofficeApp.locations.edit"]).config(["$routeProvider",function(a){a.when("/locations",{templateUrl:"backoffice_app/locations/locations.html",controller:"locationsCtrl"})}]).controller("locationsCtrl",["$scope","locations","$location","$filter",function(a,h,f,k){function e(){h.get(c,function(b,g){angular.equals([],b.data)||(angular.isDefined(c.order_by)&&""!=c.order_by&&-1<c.order_by.indexOf("id ASC")&&(b=k("orderBy")(b,
"-id")),a.cities=b.data,a.tableData.first_id=angular.isDefined(b.first_id)?b.first_id:null,a.tableData.last_id=angular.isDefined(b.last_id)?b.last_id:null,a.tableData.total=angular.isDefined(b.total)?b.total:0,a.show_prev_btn=angular.isDefined(a.tableData.last_id)&&!angular.equals([],a.cities)?a.tableData.last_id==a.cities[0].id?!1:!0:!1,a.show_next_btn=angular.isDefined(a.tableData.first_id)&&!angular.equals([],a.cities)?a.tableData.first_id==a.cities[a.cities.length-1].id?!1:!0:!1)})}a.app.state=
"locations";a.perPageArray=[25,50,100,200];a.show_prev_btn=!1;a.show_next_btn=!1;a.cities=[];a.tableData={};var c=f.search();angular.isDefined(c.per_page)?a.result=c.per_page<=a.perPageArray[a.perPageArray.length-1]?""+c.per_page:""+a.perPageArray[a.perPageArray.length-1]:a.result=""+a.perPageArray[0];c.fields="id,city";e();a.view=function(b){""!=b&&h.get({id:b},function(b,d){200!=d||angular.equals([],b.data)||(a.city=b.data[0]);jQuery("#viewCity").modal("show")})};a.next=function(){angular.equals([],
a.cities)||f.search({per_page:a.result,where:"id<"+a.cities[a.cities.length-1].id})};a.prev=function(){angular.equals([],a.cities)||f.search({per_page:a.result,where:"id>"+a.cities[0].id,order_by:"id ASC"})};a.load=function(b){angular.equals([],a.cities)||f.search({per_page:a.result,where:"id<="+a.cities[0].id})};a.delete=function(a){confirm("Delete City ?")&&h.delete(a,function(a,b){500==b?alert(a.error):e()})}}]);
angular.module("locationsService",[]).factory("locations",["$http","$rootScope","$httpParamSerializerJQLike","$filter",function(a,h,f,k){return{get:function(e,c){var b="?";angular.forEach(e,function(a,d){b+=d+"="+a+"&"});b=b.substring(0,b.length-1);a.get("/api/locations/cities"+b).success(function(a,b,l,e){angular.forEach(a.data,function(b,d){a.data[d].areas=angular.fromJson(b.areas)});c(a,b)}).error(function(a,b,l,e){c(a,b)})},save:function(e,c){var b=document.cookie.replace(/(?:(?:^|.*;\s*)csrf_cookie\s*\=\s*([^;]*).*$)|^.*$/,
"$1"),b=f({location:e,csrf_token:b});a.post("/api/locations/cities",b,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(a,b,l,e){c(a,b)}).error(function(a,b,l,e){c(a,b)})},update:function(e,c){var b=document.cookie.replace(/(?:(?:^|.*;\s*)csrf_cookie\s*\=\s*([^;]*).*$)|^.*$/,"$1"),b=f({location:e,csrf_token:b});a.put("/api/locations/cities/"+e.id,b,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(a,b,l,e){c(a,b)}).error(function(a,b,l,
e){c(a,b)})},delete:function(e,c){a.delete("/api/locations/cities/"+e.id).success(function(a,g,d,l){c(a,g)}).error(function(a,g,d,l){c(a,g)})}}}]);"use strict";
angular.module("backofficeApp.builder",["ngRoute","backofficeApp.builder.create","backofficeApp.builder.edit","backofficeApp.builder.media"]).config(["$routeProvider",function(a,h){a.when("/builder",{templateUrl:"backoffice_app/builder/builder.html",controller:"builderCtrl"})}]).controller("builderCtrl",["$scope","builder","$location","$filter",function(a,h,f,k){function e(){h.get(c,function(b,g){angular.equals([],b.data)||(angular.isDefined(c.order_by)&&""!=c.order_by&&-1<c.order_by.indexOf("id ASC")&&
(b=k("orderBy")(b,"-id")),a.builder=b.data,a.tableData.first_id=angular.isDefined(b.first_id)?b.first_id:null,a.tableData.last_id=angular.isDefined(b.last_id)?b.last_id:null,a.tableData.total=angular.isDefined(b.total)?b.total:0,a.show_prev_btn=angular.isDefined(a.tableData.last_id)&&!angular.equals([],a.builder)?a.tableData.last_id==a.builder[0].id?!1:!0:!1,a.show_next_btn=angular.isDefined(a.tableData.first_id)&&!angular.equals([],a.builder)?a.tableData.first_id==a.builder[a.builder.length-1].id?
!1:!0:!1)})}a.app.state="builders";a.perPageArray=[25,50,100,200];a.show_prev_btn=!1;a.show_next_btn=!1;a.builder=[];a.tableData={};var c=f.search();angular.isDefined(c.per_page)?a.result=c.per_page<=a.perPageArray[a.perPageArray.length-1]?""+c.per_page:""+a.perPageArray[a.perPageArray.length-1]:a.result=""+a.perPageArray[0];e();a.next=function(){angular.equals([],a.builder)||f.search({per_page:a.result,where:"id<"+a.builder[a.builder.length-1].id})};a.prev=function(){angular.equals([],a.builder)||
f.search({per_page:a.result,where:"id>"+a.builder[0].id,order_by:"id ASC"})};a.load=function(b){angular.equals([],a.builder)||f.search({per_page:a.result,where:"id<="+a.builder[0].id})};a.view=function(b){""!=b&&h.get({id:b},function(b,d){200!=d||angular.equals([],b.data)||(a.builderData=b.data[0]);""!=a.builderData.logo_link?a.builderData.logo_link=angular.fromJson(a.builderData.logo_link):(a.builderData.logo_link={logo:[]},a.builderData.logo_link.logo[0]="//:0");jQuery("#viewBuilder").modal("show")})};
a.delete=function(a){confirm("Delete Builder ?")&&h.delete(a,function(a,b){500==b?alert(a.error):e()})}}]);
angular.module("builderService",[]).factory("builder",["$http","$rootScope","$httpParamSerializerJQLike","$filter",function(a,h,f,k){return{get:function(e,c){var b="?";angular.forEach(e,function(a,d){b+=d+"="+a+"&"});b=b.substring(0,b.length-1);a.get("api/builder/builder"+b).success(function(a,b,l,e){c(a,b)}).error(function(a,b,l,e){c(a,b)})},save:function(e,c){var b=document.cookie.replace(/(?:(?:^|.*;\s*)csrf_cookie\s*\=\s*([^;]*).*$)|^.*$/,"$1"),b=f({builder:e,csrf_token:b});a.post("/api/builder/builder",
b,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(a,b,l,e){c(a,b)}).error(function(a,b,l,e){c(a,b)})},update:function(e,c){var b=document.cookie.replace(/(?:(?:^|.*;\s*)csrf_cookie\s*\=\s*([^;]*).*$)|^.*$/,"$1"),b=f({builder:e,csrf_token:b});a.put("/api/builder/builder/"+e.id,b,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(a,b,l,e){c(a,b)}).error(function(a,b,l,e){c(a,b)})},delete:function(e,c){a.delete("/api/builder/builder/"+e.id).success(function(a,
g,d,l){c(a,g)}).error(function(a,g,d,l){c(a,g)})}}}]);"use strict";
var propertiesApp=angular.module("backofficeApp.builder.media",["ngRoute"]).config(["$routeProvider",function(a){a.when("/builder/media/:id",{templateUrl:"backoffice_app/builder/media/builderMediaView.html",controller:"builderMediaCtrl"})}]).controller("builderMediaCtrl",["$scope","builder","$routeParams","fileService",function(a,h,f,k){a.app.state="builders";h.get({id:f.id,fields:"id,builder_name,logo_link"},function(e,c){angular.equals([],e.data)||(a.builder=e.data[0],a.builder.logo_link&&(a.builder.logo_link=
angular.fromJson(a.builder.logo_link)))});a.delete=function(e,c){if(confirm("Delete ?")){var b=angular.copy(a.builder);b.logo_link.logo.splice(c,1);b.logo_link=angular.toJson(b.logo_link);h.update(b,function(b,d){400==d?alert(b):(a.builder.logo_link.logo.splice(c,1),k.delete(e,function(a,b){console.log(a,b)}))})}}}]);"use strict";
angular.module("backofficeApp.builder.create",["ngRoute"]).config(["$routeProvider",function(a){a.when("/builder/add",{templateUrl:"backoffice_app/builder/create/createBuilderView.html",controller:"createbuilderCtrl"})}]).controller("createbuilderCtrl",["$scope","$http","builder",function(a,h,f){a.save=function(h){h.$valid&&h.$dirty&&f.save(a.builder,function(a,c){201==c?(alert("Created"),window.location="#/builder"):alert(a)})}}]);"use strict";
angular.module("backofficeApp.specifications",["ngRoute","backofficeApp.specification.create","backofficeApp.specification.media"]).config(["$routeProvider",function(a){a.when("/specifications",{templateUrl:"backoffice_app/specifications/specifications.html",controller:"specificationsCtrl"})}]).controller("specificationsCtrl",["$scope","$http","specifications","$location","$filter",function(a,h,f,k,e){function c(){f.get(b,function(g,d){angular.equals([],g.data)||(angular.isDefined(b.order_by)&&""!=
b.order_by&&-1<b.order_by.indexOf("id ASC")&&(g=e("orderBy")(g,"-id")),a.specifications=g.data,a.tableData.first_id=angular.isDefined(g.first_id)?g.first_id:null,a.tableData.last_id=angular.isDefined(g.last_id)?g.last_id:null,a.tableData.total=angular.isDefined(g.total)?g.total:0,a.show_prev_btn=angular.isDefined(a.tableData.last_id)&&!angular.equals([],a.specifications)?a.tableData.last_id==a.specifications[0].id?!1:!0:!1,a.show_next_btn=angular.isDefined(a.tableData.first_id)&&!angular.equals([],
a.specifications)?a.tableData.first_id==a.specifications[a.specifications.length-1].id?!1:!0:!1)})}a.app.state="specifications";a.perPageArray=[25,50,100,200];a.show_prev_btn=!1;a.show_next_btn=!1;a.specifications=[];a.tableData={};var b=k.search();angular.isDefined(b.per_page)?a.result=b.per_page<=a.perPageArray[a.perPageArray.length-1]?""+b.per_page:""+a.perPageArray[a.perPageArray.length-1]:a.result=""+a.perPageArray[0];c();a.next=function(){angular.equals([],a.specifications)||k.search({per_page:a.result,
where:"id<"+a.specifications[a.specifications.length-1].id})};a.prev=function(){angular.equals([],a.specifications)||k.search({per_page:a.result,where:"id>"+a.specifications[0].id,order_by:"id ASC"})};a.load=function(b){angular.equals([],a.specifications)||k.search({per_page:a.result,where:"id<="+a.specifications[0].id})};a.delete=function(a){confirm("Delete Specification ?")&&f.delete(a,function(a,b){500==b?alert(a.error):c()})}}]);
angular.module("specificationsService",[]).factory("specifications",["$http","$rootScope","$httpParamSerializerJQLike","$filter",function(a,h,f,k){return{get:function(e,c){var b="?";angular.forEach(e,function(a,d){b+=d+"="+a+"&"});b=b.substring(0,b.length-1);a.get("api/specifications/specifications"+b).success(function(a,b,l,e){c(a,b)}).error(function(a,b,l,e){c(a,b)})},save:function(e,c){var b=document.cookie.replace(/(?:(?:^|.*;\s*)csrf_cookie\s*\=\s*([^;]*).*$)|^.*$/,"$1"),b=f({specifications:e,
csrf_token:b});a.post("/api/specifications/specifications",b,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(a,b,l,e){c(a,b)}).error(function(a,b,l,e){c(a,b)})},update:function(e,c){var b=document.cookie.replace(/(?:(?:^|.*;\s*)csrf_cookie\s*\=\s*([^;]*).*$)|^.*$/,"$1"),b=f({specification:e,csrf_token:b});a.put("/api/specifications/specifications/"+e.id,b,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(a,b,l,e){c(a,b)}).error(function(a,
b,l,e){c(a,b)})},delete:function(e,c){a.delete("/api/specifications/specifications/"+e.id).success(function(a,g,d,l){c(a,g)}).error(function(a,g,d,l){c(a,g)})}}}]);"use strict";
propertiesApp=angular.module("backofficeApp.specification.media",["ngRoute"]).config(["$routeProvider",function(a){a.when("/specification/media/:id",{templateUrl:"backoffice_app/specifications/media/specificationMediaView.html",controller:"specificationMediaCtrl"})}]).controller("specificationMediaCtrl",["$scope","specifications","$routeParams","fileService",function(a,h,f,k){a.app.state="specifications";h.get({id:f.id,fields:"id,name,icon_path"},function(e,c){angular.equals([],e.data)||(a.specification=
e.data[0],angular.isDefined(a.specification.icon_path)&&""!=a.specification.icon_path&&(a.specification.icon_path=angular.fromJson(a.specification.icon_path)))});a.delete=function(e,c){if(confirm("Delete ?")){var b=angular.copy(a.specification);b.icon_path.logo.splice(c,1);b.icon_path=angular.toJson(b.icon_path);h.update(b,function(b,d){400==d?alert(b):(a.specification.icon_path.logo.splice(c,1),k.delete(e,function(a,b){console.log(a,b)}))})}}}]);"use strict";
angular.module("backofficeApp.specification.create",["ngRoute"]).config(["$routeProvider",function(a){a.when("/specifications/add",{templateUrl:"backoffice_app/specifications/create/createSpecificationView.html",controller:"createspecificationCtrl"})}]).controller("createspecificationCtrl",["$scope","$http","specifications",function(a,h,f){a.save=function(h){h.$valid&&h.$dirty&&f.save(a.specification,function(a,c){201==c?(alert("Created"),window.location="#/specifications"):alert(a)})}}]);"use strict";
angular.module("backofficeApp.locations.create",["ngRoute"]).config(["$routeProvider",function(a){a.when("/locations/add",{templateUrl:"backoffice_app/locations/create/createLocationsView.html",controller:"createLocationsCtrl"})}]).controller("createLocationsCtrl",["$scope","$http","locations",function(a,h,f){a.save=function(h){if(h.$valid&&h.$dirty){var e={};e.areas=a.location.areas.split("#");angular.forEach(e.areas,function(a,b){e.areas[b]=a.trim()});e.city=a.location.city;f.save(e,function(a,
b){201==b?(alert("Created"),window.location="#/locations"):alert(a)})}}}]);"use strict";
angular.module("backofficeApp.locations.edit",["ngRoute"]).config(["$routeProvider",function(a){a.when("/locations/edit/:id",{templateUrl:"backoffice_app/locations/edit/editLocationsView.html",controller:"editLocationsCtrl"})}]).controller("editLocationsCtrl",["$scope","$http","$routeParams","locations","$filter",function(a,h,f,k,e){h=f.id;a.location=[];k.get({id:h},function(c,b){200==b?(a.location=c.data[0],a.location.areas=a.location.areas.join("#\n")):console.log(c)});a.update=function(c){if(c.$valid&&
c.$dirty){var b={};b.areas=a.location.areas.split("#");b.id=a.location.id;angular.forEach(b.areas,function(a,d){b.areas[d]=a.trim()});b.city=a.location.city;k.update(b,function(a,b){204==b?(alert("Updated"),window.location="backoffice#/locations"):console.log(a)})}}}]);"use strict";
angular.module("backofficeApp.builder.edit",["ngRoute"]).config(["$routeProvider",function(a){a.when("/builder/edit/:id",{templateUrl:"backoffice_app/builder/edit/editBuilderView.html",controller:"editBuilderCtrl"})}]).controller("editBuilderCtrl",["$scope","$http","$routeParams","$filter","builder",function(a,h,f,k,e){h=f.id;a.builder=[];e.get({id:h},function(c,b){200==b?a.builder=c.data[0]:console.log(c)});a.update=function(c){c.$valid&&c.$dirty&&(c={},c=a.builder,c.id=a.builder.id,e.update(c,function(a,
g){204==g?(alert("Updated"),window.location=window.history.back()):console.log(a)}))}}]);"use strict";
angular.module("backofficeApp.properties","ngRoute backofficeApp.properties.view backofficeApp.properties.create backofficeApp.properties.edit backofficeApp.properties.media backofficeApp.properties.units".split(" ")).config(["$routeProvider",function(a){a.when("/properties",{templateUrl:"backoffice_app/properties/properties.html",controller:"propertiesCtrl"})}]).controller("propertiesCtrl",["$scope","properties","$location","$filter","builder","locations",function(a,h,f,k,e,c){function b(){d.get_all_projects=
1;h.get(d,function(b,g){angular.equals([],b.data)||(angular.isDefined(d.order_by)&&""!=d.order_by&&-1<d.order_by.indexOf("id ASC")&&(b=k("orderBy")(b,"-project_id")),a.properties=b.data,angular.forEach(b.data,function(a,b){a.is_live=parseInt(a.is_live)}));a.tableData.first_id=angular.isDefined(b.first_id)?b.first_id:null;a.tableData.last_id=angular.isDefined(b.last_id)?b.last_id:null;a.tableData.total=angular.isDefined(b.total)?b.total:0;a.show_prev_btn=angular.isDefined(a.tableData.last_id)&&!angular.equals([],
a.properties)?a.tableData.last_id==a.properties[0].project_id?!1:!0:!1;a.show_next_btn=angular.isDefined(a.tableData.first_id)&&!angular.equals([],a.properties)?a.tableData.first_id==a.properties[a.properties.length-1].project_id?!1:!0:!1})}function g(a){angular.forEach(a,function(b,g){switch(g){case "per_page":d.per_page=a[g];""==d.per_page&&delete d.per_page;break;case "where":!angular.equals({},d)&&angular.isDefined(d.where)?(-1!=d.where.indexOf("builder_id")&&-1!=a.where.indexOf("builder_id")?
d.where=d.where.replace(/builder_id.+?\([0-9,]+\)/,a.where):-1!=a.where.indexOf("builder_id")?d.where+=" and "+a.where:-1!=d.where.indexOf("builder_id")&&"deleteBuilder_id"==a.where&&(d.where=d.where.replace(/\s*(?:and){0,1}\s*builder_id.+?\([0-9,]+\)/,"")),-1!=d.where.indexOf("min_price")&&-1!=a.where.indexOf("min_price")?d.where=d.where.replace(/min_price.+and [0-9,]+/,a.where):-1!=a.where.indexOf("min_price")?d.where+=" and "+a.where:-1!=d.where.indexOf("min_price")&&"deletePrice"==a.where&&(d.where=
d.where.replace(/\s*(?:and){0,1}\s*min_price.+and [0-9,]+/,"")),-1!=d.where.indexOf("city")&&-1!=a.where.indexOf("city")?d.where=d.where.replace(/city in \([a-zA-Z,\s-_]+\)/,a.where):-1!=a.where.indexOf("city")?d.where+=" and "+a.where:-1!=d.where.indexOf("city")&&"deleteCity"==a.where&&(d.where=d.where.replace(/\s*(?:and){0,1}\s*city in \([a-zA-z,\s-_]+\)/,"")),d.where=d.where.replace(/^\s*(?:and){0,1}\s*/,"")):d.where=a.where;""==d.where&&delete d.where;break;case "order_by":d.order_by=a.order_by;
""==d.order_by&&delete d.order_by;break;case "get_for":d.get_for=a.get_for;""==d.get_for&&delete d.get_for;break;case "selectedPriceIds":d.selectedPriceIds=a.selectedPriceIds;""==d.selectedPriceIds&&delete d.selectedPriceIds;break;case "selectedUnits":d.units=a.selectedUnits;""==d.units&&delete d.units;break;case "possessions":d.possessions=a.possessions,""==d.possessions&&delete d.possessions}});f.search(d)}a.app.state="properties";a.perPageArray=[25,50,100,200];a.show_prev_btn=!1;a.show_next_btn=
!1;a.properties=[];a.tableData={};var d=f.search();angular.isDefined(d.per_page)?a.result=d.per_page<=a.perPageArray[a.perPageArray.length-1]?""+d.per_page:""+a.perPageArray[a.perPageArray.length-1]:a.result=""+a.perPageArray[0];b();a.setValue=function(b){jQuery("#toggleProject + label").css("pointer-events","none");h.update({project_id:a.properties[b].project_id,is_live:a.properties[b].is_live},function(d,g){204!=g&&(a.properties[b].is_live=1==a.properties[b].is_live?0:1,console.log(d));jQuery("#toggleProject + label").css("pointer-events",
"auto")})};c.get({limit:1E4,fields:"id,city"},function(b,g){angular.equals([],b.data)||(a.cities=b.data);angular.isDefined(d.where)&&-1!=d.where.indexOf("city")&&angular.forEach(d.where.match(/city in \(([a-zA-z,\s-_]+)\)/)[1].split(","),function(b){angular.isDefined(b=k("filter")(a.cities,{city:b},!0)[0])&&(a.cities[a.cities.indexOf(b)].is_checked=1)})});e.get({limit:1E4},function(b,g){angular.equals([],b.data)||(a.builders=b.data);angular.isDefined(d.where)&&-1!=d.where.indexOf("builder_id")&&angular.forEach(d.where.match(/builder_id in \((.+?)(?=\))/)[1].split(","),
function(b){angular.isDefined(b=k("filter")(a.builders,{id:b},!0)[0])&&(a.builders[a.builders.indexOf(b)].is_checked=1)})});a.next=function(){if(!angular.equals([],a.properties)){var b={};angular.isDefined(d)&&angular.copy(d,b);angular.isDefined(b.where)&&""!=b.where&&delete b.where;b.per_page=a.result;b.get_for="id<"+a.properties[a.properties.length-1].project_id;g(b)}};a.prev=function(){if(!angular.equals([],a.properties)){var b={};angular.isDefined(d)&&angular.copy(d,b);angular.isDefined(b.where)&&
""!=b.where&&delete b.where;b.per_page=a.result;b.get_for="id>"+a.properties[0].project_id;b.order_by="id ASC";g(b)}};a.load=function(b){angular.equals([],a.properties)||(b={},angular.isDefined(d)&&angular.copy(d,b),angular.isDefined(b.where)&&""!=b.where&&delete b.where,b.per_page=a.result,b.get_for="id<="+a.properties[0].project_id,b.order_by="",g(b))};a.delete=function(a){confirm("Delete Project ?")&&h.delete(a,function(a,d){500==d?alert(a.error):b()})};a.possessions=[{id:1,text:"Ready to move in",
min_val:0,max_val:0,is_checked:0},{id:2,text:"0 to 6 months",min_val:0,max_val:6,is_checked:0},{id:3,text:"6 to 12 months",min_val:6,max_val:12,is_checked:0},{id:4,text:"1 to 2 years",min_val:12,max_val:24,is_checked:0},{id:5,text:"More than two years",min_val:24,max_val:5E3,is_checked:0}];a.priceRanges=[{id:1,text:"Less than 30 Lakhs",min_val:0,max_val:3E6,is_checked:0},{id:2,text:"Between 30 to 50 Lakhs",min_val:3E6,max_val:5E6,is_checked:0},{id:3,text:"Between 50 to 80 Lakhs",min_val:5E6,max_val:8E6,
is_checked:0},{id:6,text:"More than 80 Crore",min_val:8E6,max_val:1E10,is_checked:0}];a.unitTypes=[{text:"2 BHK",is_checked:0},{text:"3 BHK",is_checked:0},{text:"4 BHK",is_checked:0},{text:"Studio Apartments",is_checked:0},{text:"Villa",is_checked:0},{text:"Plot",is_checked:0},{text:"Office Space",is_checked:0},{text:"Showrooms or Shops",is_checked:0},{text:"Hotels",is_checked:0}];angular.isDefined(d.possessions)&&""!=d.possessions&&angular.forEach(d.possessions,function(b){angular.isDefined(b=k("filter")(a.possessions,
{id:parseInt(b)},!0)[0])&&(a.possessions[a.possessions.indexOf(b)].is_checked=1)});angular.isDefined(d.units)&&""!=d.units&&(e=d.units.split(","),angular.forEach(e,function(b,d){var g;angular.isDefined(g=k("filter")(a.unitTypes,{text:b},!0)[0])&&(a.unitTypes[a.unitTypes.indexOf(g)].is_checked=1)}));angular.isDefined(d.selectedPriceIds)?(e=d.selectedPriceIds.split(","),angular.forEach(e,function(b){angular.isDefined(b=k("filter")(a.priceRanges,{id:parseInt(b)},!0)[0])&&(a.priceRanges[a.priceRanges.indexOf(b)].is_checked=
1)})):(e={},angular.isDefined(d.where)&&(angular.copy(d,e),e.where="deletePrice",e.order_by="",e.get_for="",g(e)));a.getByPrice=function(){var b=[],c=[],e=[];angular.forEach(a.priceRanges,function(a,d){1==a.is_checked&&(b.push(a.min_val),c.push(a.max_val),e.push(a.id))});var f={};angular.isDefined(d)&&angular.copy(d,f);if(angular.equals([],b))f.where="deletePrice";else{for(var h="",k=0;k<=b.length-1;k++)h+="min_price between "+b[k]+" and "+c[k]+" OR ";h=h.substring(0,h.length-4);f.where=h}angular.equals([],
e)?f.selectedPriceIds="":f.selectedPriceIds=e.join(",");f.order_by="";f.get_for="";g(f)};a.getByPossession=function(){var b=[];angular.forEach(a.possessions,function(a,d){1==a.is_checked&&b.push(a.id)});var c={};angular.isDefined(d)&&angular.copy(d,c);angular.equals([],b)?c.possessions="":c.possessions=""+b.join();c.order_by="";c.get_for="";g(c)};a.getByBuilder=function(){var b=[];angular.forEach(a.builders,function(a,d){1==a.is_checked&&b.push(a.id)});var c={};angular.isDefined(d)&&angular.copy(d,
c);angular.equals([],b)?c.where="deleteBuilder_id":c.where="builder_id in ("+b.join()+")";c.order_by="";c.get_for="";g(c)};a.getByCity=function(){var b=[];angular.forEach(a.cities,function(a,d){1==a.is_checked&&b.push(a.city)});var c={};angular.isDefined(d)&&angular.copy(d,c);angular.equals([],b)?c.where="deleteCity":c.where="city in ("+b.join()+")";c.order_by="";c.get_for="";g(c)};a.getByUnit=function(){var b=[];angular.forEach(a.unitTypes,function(a,d){1==a.is_checked&&b.push(a.text)});var c={};
angular.isDefined(d)&&angular.copy(d,c);angular.isDefined(c.where)&&""!=c.where&&delete c.where;angular.equals([],b)?c.selectedUnits="":c.selectedUnits=b.join();c.order_by="";c.get_for="";g(c)}}]);
angular.module("propertiesService",[]).factory("properties",["$http","$rootScope","$httpParamSerializerJQLike","$filter",function(a,h,f,k){return{get:function(e,c){var b="?";angular.forEach(e,function(a,d){b+=d+"="+a+"&"});b=b.substring(0,b.length-1);a.get("/api/properties/projects"+b).success(function(a,b,e,f){c(a,b)}).error(function(a,b,e,f){c(a,b)})},save:function(e,c){var b=document.cookie.replace(/(?:(?:^|.*;\s*)csrf_cookie\s*\=\s*([^;]*).*$)|^.*$/,"$1"),b=f({property:e,csrf_token:b});a.post("/api/properties/projects",
b,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(a,b,e,f){c(a,b)}).error(function(a,b,e,f){c(a,b)})},update:function(e,c){var b=document.cookie.replace(/(?:(?:^|.*;\s*)csrf_cookie\s*\=\s*([^;]*).*$)|^.*$/,"$1"),b=f({property:e,csrf_token:b});a.put("/api/properties/projects/"+e.project_id,b,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(a,b,e,f){c(a,b)}).error(function(a,b,e,f){c(a,b)})},delete:function(e,c){a.delete("/api/properties/projects/"+
e.project_id).success(function(a,g,d,e){c(a,g)}).error(function(a,g,d,e){c(a,g)})}}}]);"use strict";
angular.module("backofficeApp.properties.create",["ngRoute","backoffice.file_upload"]).config(["$routeProvider",function(a){a.when("/properties/add",{templateUrl:"backoffice_app/properties/create/createPropertyView.html",controller:"createPropertyCtrl"})}]).controller("createPropertyCtrl",["$scope","locations","properties","$filter","builder","specifications",function(a,h,f,k,e,c){a.app.state="properties";h.get({limit:1E3},function(b,c){angular.equals([],b.data)||(a.cities=b.data,a.areas=a.cities[0].areas,
a.property.city=a.cities[0].city,a.property.area=a.cities[0].areas[0])});c.get({limit:1E3,fields:"id,name"},function(b,c){angular.equals([],b.data)||(a.specifications=b.data)});e.get({limit:100},function(b,c){angular.equals([],b.data)||(a.builders=b.data,a.property.builder_id=a.builders[0].id)});a.changeArea=function(){a.areas=k("filter")(a.cities,{city:a.property.city},!0)[0].areas;a.property.area=a.areas[0]};a.save=function(b){if(b.$valid&&b.$dirty){var c={},c=a.property;c.data.specifications=[];
angular.forEach(a.specifications,function(a,b){angular.isDefined(a.is_checked)&&0!=a.is_checked&&c.data.specifications.push(a.id)});c.min_price=parseFloat(a.min_price_value)*parseInt(a.min_price_unit_value);c.max_price=parseFloat(a.max_price_value)*parseInt(a.max_price_unit_value);f.save(c,function(a,b){201==b?(alert("Created"),window.location="#/properties"):alert(a)})}}}]);"use strict";
angular.module("backofficeApp.properties.edit",["ngRoute"]).config(["$routeProvider",function(a){a.when("/properties/edit/:id",{templateUrl:"backoffice_app/properties/edit/editPropertyView.html",controller:"editPropertyCtrl"})}]).controller("editPropertyCtrl",["$scope","$routeParams","locations","properties","$filter","builder","specifications",function(a,h,f,k,e,c,b){function g(){a.locationsRetrived&&a.buildersRetrived&&a.propertyRetrived&&a.specificationsRetrived&&(a.property.city=d.city,a.areas=
e("filter")(a.cities,{city:a.property.city},!0)[0].areas,a.property.area=d.area,a.property.builder_id=d.builder_id,setTimeout(function(){a.$broadcast("updateCkeditor");a.property.data=d.data},1E3),angular.forEach(d.data.specifications,function(b,d){e("filter")(a.specifications,{id:b},!0)[0].is_checked=1}))}a.app.state="properties";h=h.id;var d={};a.locationsRetrived=!1;a.buildersRetrived=!1;a.propertyRetrived=!1;a.specificationsRetrived=!1;a.property={};b.get({limit:1E3,fields:"id,name"},function(b,
d){angular.equals([],b.data)||(a.specifications=b.data,a.specificationsRetrived=!0,g())});f.get({limit:1E3},function(b,d){angular.equals([],b.data)||(a.cities=b.data,a.areas=a.cities[0].areas,a.property.city=a.cities[0].city,a.property.area=a.cities[0].areas[0],a.locationsRetrived=!0,g())});c.get({limit:100},function(b,d){angular.equals([],b.data)||(a.builders=b.data,a.buildersRetrived=!0,g())});a.changeArea=function(){a.areas=e("filter")(a.cities,{city:a.property.city},!0)[0].areas;a.property.area=
a.areas[0]};k.get({id:h,get_all_projects:1},function(b,c){200!=c||angular.equals([],b.data)?console.log(b):(a.propertyRetrived=!0,angular.copy(b.data[0],d),d.possession=new Date(d.possession),""!=d.data&&(d.data=angular.fromJson(b.data[0].data)),1E5>d.min_price?(a.min_price_value=d.min_price/1E3,a.min_price_unit_value="1000"):1E7>d.min_price?(a.min_price_value=d.min_price/1E5,a.min_price_unit_value="100000"):(a.min_price_value=d.min_price/1E7,a.min_price_unit_value="10000000"),1E5>d.max_price?(a.max_price_value=
d.max_price/1E3,a.max_price_unit_value="1000"):1E7>d.man_price?(a.max_price_value=d.max_price/1E5,a.max_price_unit_value="100000"):(a.max_price_value=d.max_price/1E7,a.max_price_unit_value="10000000"),angular.copy(d,a.property),g())});a.update=function(b){b.$valid&&b.$dirty&&(angular.copy(a.property,d),d.min_price=parseFloat(a.min_price_value)*parseInt(a.min_price_unit_value),d.max_price=parseFloat(a.max_price_value)*parseInt(a.max_price_unit_value),d.data.specifications=[],angular.forEach(a.specifications,
function(a,b){angular.isDefined(a.is_checked)&&0!=a.is_checked&&d.data.specifications.push(a.id)}),k.update(d,function(a,b){204==b?(alert("Updated"),window.location="#/properties"):alert(a)}))}}]);"use strict";
propertiesApp=angular.module("backofficeApp.properties.view",["ngRoute"]).config(["$routeProvider",function(a){a.when("/properties/view/:id",{templateUrl:"backoffice_app/properties/view/propertiesView.html",controller:"propertiesViewCtrl"})}]).controller("propertiesViewCtrl",["$scope","properties","$routeParams",function(a,h,f){a.app.state="properties";h.get({id:f.id,get_all_projects:1},function(f,e){angular.equals([],f.data)||(a.property=f.data)})}]);"use strict";
angular.module("backofficeApp.properties.units",["ngRoute","ngSanitize","backofficeApp.properties.units.create","backofficeApp.properties.units.media","backofficeApp.properties.units.edit"]).config(["$routeProvider",function(a){a.when("/properties/:id/units",{templateUrl:"backoffice_app/properties/units/unitsView.html",controller:"unitsCtrl"})}]).controller("unitsCtrl",["$scope","units","$location","$filter","$routeParams",function(a,h,f,k,e){function c(){h.get(b,function(c,d){angular.equals([],c.data)||
(angular.isDefined(b.order_by)&&""!=b.order_by&&-1<b.order_by.indexOf("id ASC")&&(c.data=k("orderBy")(c.data,"-id")),a.units=c.data,a.tableData.first_id=angular.isDefined(c.first_id)?c.first_id:null,a.tableData.last_id=angular.isDefined(c.last_id)?c.last_id:null,a.tableData.total=angular.isDefined(c.total)?c.total:0,a.show_prev_btn=angular.isDefined(a.tableData.last_id)&&!angular.equals([],a.units)?a.tableData.last_id==a.units[0].id?!1:!0:!1,a.show_next_btn=angular.isDefined(a.tableData.first_id)&&
!angular.equals([],a.units)?a.tableData.first_id==a.units[a.units.length-1].id?!1:!0:!1)})}a.p_id=e.id;a.app.state="properties";a.perPageArray=[25,50,100,200];a.show_prev_btn=!1;a.show_next_btn=!1;var b=f.search();a.tableData={};angular.isDefined(b.per_page)?a.result=b.per_page<=a.perPageArray[a.perPageArray.length-1]?""+b.per_page:""+a.perPageArray[a.perPageArray.length-1]:a.result=""+a.perPageArray[0];angular.isDefined(b.where)&&""!=b.where?b.where=b.where+" AND p_id="+a.p_id:b.where="id>0 AND p_id="+
a.p_id;c();a.next=function(){a.units!=[]&&f.search({per_page:a.result,where:"id<"+a.units[a.units.length-1].id})};a.prev=function(){a.units!=[]&&f.search({per_page:a.result,where:"id>"+a.units[0].id,order_by:"id ASC"})};a.load=function(b){a.units!=[]&&f.search({per_page:a.result,where:"id<="+a.units[0].id})};a.delete=function(a){confirm("Delete ?")&&h.delete(a,function(a,b){500==b?alert(a.error):c()})};a.view=function(b){""!=b&&h.get({id:b},function(b,c){200!=c||angular.equals([],b.data)||(a.unit=
b.data[0]);a.unit.image_path&&(a.unit.image_path=angular.fromJson(a.unit.image_path));jQuery("#viewUnitModal").modal("show")})}}]);
angular.module("unitsService",[]).factory("units",["$http","$rootScope","$httpParamSerializerJQLike","$filter",function(a,h,f,k){return{get:function(e,c){var b="?";angular.forEach(e,function(a,d){b+=d+"="+a+"&"});b=b.substring(0,b.length-1);a.get("/api/units/units"+b).success(function(a,b,e,f){c(a,b)}).error(function(a,b,e,f){c(a,b)})},save:function(e,c){var b=document.cookie.replace(/(?:(?:^|.*;\s*)csrf_cookie\s*\=\s*([^;]*).*$)|^.*$/,"$1"),b=f({unit:e,csrf_token:b});a.post("/api/units/units",b,
{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(a,b,e,f){c(a,b)}).error(function(a,b,e,f){c(a,b)})},update:function(e,c){var b=document.cookie.replace(/(?:(?:^|.*;\s*)csrf_cookie\s*\=\s*([^;]*).*$)|^.*$/,"$1"),b=f({unit:e,csrf_token:b});a.put("/api/units/units/"+e.id,b,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(a,b,e,f){c(a,b)}).error(function(a,b,e,f){c(a,b)})},delete:function(e,c){a.delete("/api/units/units/"+e.id).success(function(a,
g,d,e){c(a,g)}).error(function(a,g,d,e){c(a,g)})}}}]);"use strict";
angular.module("backofficeApp.properties.units.create",["ngRoute"]).config(["$routeProvider",function(a){a.when("/properties/:id/units/add",{templateUrl:"backoffice_app/properties/units/create/createUnitsView.html",controller:"createUnitCtrl"})}]).controller("createUnitCtrl",["$scope","units","$routeParams",function(a,h,f){a.app.state="properties";a.unit={};a.unit.p_id=f.id;a.save=function(f){f.$valid&&f.$dirty&&(a.unit.unit_price=parseFloat(a.unit_price_value)*parseInt(a.price_unit_value),a.unit.unit_price_per_area=
parseFloat(a.unit_price_per_area_value)*parseInt(a.price_per_area_unit_value),h.save(a.unit,function(e,c){201==c?(alert("Created"),window.location="#/properties/"+a.unit.p_id+"/units"):alert(e)}))}}]);"use strict";
angular.module("backofficeApp.properties.units.edit",["ngRoute"]).config(["$routeProvider",function(a){a.when("/properties/:p_id/units/edit/:id",{templateUrl:"backoffice_app/properties/units/edit/editUnitView.html",controller:"editUnitCtrl"})}]).controller("editUnitCtrl",["$scope","$routeParams","units",function(a,h,f){var k=h.id,e=h.p_id;a.unit={};f.get({id:k},function(c,b){200==b?(a.unit=c.data[0],1E5>a.unit.unit_price?(a.unit_price_value=a.unit.unit_price/1E3,a.price_unit_value="1000"):1E7>a.unit.unit_price?
(a.unit_price_value=a.unit.unit_price/1E5,a.price_unit_value="100000"):(a.unit_price_value=a.unit.unit_price/1E7,a.price_unit_value="10000000"),1E5>a.unit.unit_price_per_area?(a.unit_price_per_area_value=a.unit.unit_price_per_area/1E3,a.price_per_area_unit_value="1000"):1E7>a.unit.unit_price_per_area?(a.unit_price_per_area_value=a.unit.unit_price_per_area/1E5,a.price_per_area_unit_value="100000"):(a.unit_price_per_area_value=a.unit.unit_price_per_area/1E7,a.price_per_area_unit_value="10000000"),a.unit.unit_area=
parseFloat(a.unit.unit_area),a.unit.p_id=e):console.log(c)});a.update=function(c){if(c.$valid&&c.$dirty){var b=a.unit;a.unit.unit_price=parseFloat(a.unit_price_value)*parseInt(a.price_unit_value);a.unit.unit_price_per_area=parseFloat(a.unit_price_per_area_value)*parseInt(a.price_per_area_unit_value);a.unit.unit_area=parseFloat(a.unit.unit_area);f.update(b,function(a,c){204==c?(alert("Updated"),window.location="#/properties/"+b.p_id+"/units"):console.log(a)})}}}]);"use strict";
propertiesApp=angular.module("backofficeApp.properties.media",["ngRoute"]).config(["$routeProvider",function(a){a.when("/properties/media/:id",{templateUrl:"backoffice_app/properties/media/mediaView.html",controller:"mediaCtrl"})}]).controller("mediaCtrl",["$scope","properties","$routeParams","fileService",function(a,h,f,k){a.app.state="properties";h.get({id:f.id,fields:"project_id,name,media",get_all_projects:1},function(e,c){angular.equals([],e.data)||(a.property=e.data[0],a.property.media&&(a.property.media=
angular.fromJson(a.property.media)))});a.delete=function(e,c,b){if(confirm("Delete ?")){var g=angular.copy(a.property);g.media.property[b].splice(c,1);g.media=angular.toJson(g.media);h.update(g,function(d,g){400==g?alert(d):(a.property.media.property[b].splice(c,1),k.delete(e,function(a,b){console.log(a,b)}))})}}}]);"use strict";
propertiesApp=angular.module("backofficeApp.properties.units.media",["ngRoute"]).config(["$routeProvider",function(a){a.when("/units/media/:id",{templateUrl:"backoffice_app/properties/units/media/mediaView.html",controller:"unitsMediaCtrl"})}]).controller("unitsMediaCtrl",["$scope","units","$routeParams","fileService",function(a,h,f,k){a.app.state="properties";h.get({id:f.id,fields:"id,image_path,unit_name"},function(e,c){angular.equals([],e.data)||(a.unit=e.data[0],a.unit.image_path&&(a.unit.image_path=
angular.fromJson(a.unit.image_path)))});a.delete=function(e,c){if(confirm("Delete ?")){var b=angular.copy(a.unit);b.image_path.img.splice(c,1);b.image_path=angular.toJson(b.image_path);h.update(b,function(b,d){400==d?alert(b):(a.unit.image_path.img.splice(c,1),k.delete(e,function(a,b){console.log(a,b)}))})}}}]);
backofficeApp.directive("ckEditor",[function(){return{require:"?ngModel",link:function(a,h,f,k){function e(){a.$apply(function(){k.$setViewValue(c.getData())})}var c=CKEDITOR.replace(h[0]);k&&(c.on("instanceReady",function(){c.setData(k.$modelValue)}),c.on("pasteState",e),c.on("change",e),c.on("key",e),c.on("dataReady",e),c.on("paste",e),c.on("selectionChange",e),k.$render=function(a){c.setData(k.$modelValue)},a.$on("updateCkeditor",function(a){k.$render()}))}}}]);"use strict";
angular.module("backofficeApp.comments",["ngRoute"]).config(["$routeProvider",function(a,h){a.when("/comments",{templateUrl:"backoffice_app/comments/comments.html",controller:"commentsCtrl"})}]).controller("commentsCtrl",["$scope","comments","$location",function(a,h,f){function k(a){angular.forEach(a,function(g,d){switch(d){case "per_page":c.per_page=a[d];""==c.per_page&&delete c.per_page;break;case "where":c.where=a.where;""==c.where&&delete c.where;break;case "order_by":c.order_by=a.order_by,""==
c.order_by&&delete c.order_by}});f.search(c)}function e(){var b={};angular.copy(c,b);b.fields="id,user_name,user_phone,user_comment,user_email,name as project_name,projects.project_id,is_approved";h.get(b,function(c,d){angular.equals([],c.data)||(angular.isDefined(b.order_by)&&""!=b.order_by&&-1<b.order_by.indexOf("id ASC")&&(c=$filter("orderBy")(c,"-id")),angular.forEach(c.data,function(a,b){a.is_approved=parseInt(a.is_approved)}),a.comments=c.data,a.tableData.first_id=angular.isDefined(c.first_id)?
c.first_id:null,a.tableData.last_id=angular.isDefined(c.last_id)?c.last_id:null,a.tableData.total=angular.isDefined(c.total)?c.total:0,a.show_prev_btn=angular.isDefined(a.tableData.last_id)&&!angular.equals([],a.comments)?a.tableData.last_id==a.comments[0].id?!1:!0:!1,a.show_next_btn=angular.isDefined(a.tableData.first_id)&&!angular.equals([],a.comments)?a.tableData.first_id==a.comments[a.comments.length-1].id?!1:!0:!1)})}a.app.state="comments";a.perPageArray=[25,50,100,200];a.show_prev_btn=!1;a.show_next_btn=
!1;a.comments=[];a.tableData={};var c=f.search();angular.isDefined(c.per_page)?a.result=c.per_page<=a.perPageArray[a.perPageArray.length-1]?""+c.per_page:""+a.perPageArray[a.perPageArray.length-1]:a.result=""+a.perPageArray[0];e();a.next=function(){angular.equals([],a.comments)||f.search({per_page:a.result,where:"id<"+a.comments[a.comments.length-1].id})};a.prev=function(){angular.equals([],a.comments)||f.search({per_page:a.result,where:"id>"+a.comments[0].id,order_by:"id ASC"})};a.load=function(b){angular.equals([],
a.comments)||f.search({per_page:a.result,where:"id<="+a.comments[0].id})};a.setValue=function(b){jQuery("#toggleComment + label").css("pointer-events","none");h.update({id:a.comments[b].id,is_approved:a.comments[b].is_approved},function(c,d){204!=d&&(a.comments[b].is_approved=1==a.comments[b].is_approved?0:1,console.log(c));jQuery("#toggleComment + label").css("pointer-events","auto")})};a.view=function(b){""!=b&&h.get({id:b,fields:"id,user_name,user_phone,user_comment,user_email,name as project_name,projects.project_id,is_approved"},
function(b,c){200!=c||angular.equals([],b.data)||(a.comment=b.data[0]);jQuery("#viewComment").modal("show")})};!angular.equals({},c)&&angular.isDefined(c.where)&&null!=c.where.match(/is_approved in \(([0-1,]+)\)/)&&angular.forEach(c.where.match(/is_approved in \(([0-1,]+)\)/)[1].split(","),function(b,c){1==b&&(a.checkedComments=1);0==b&&(a.uncheckedComments=1)});a.getFilteredComments=function(){var b={};angular.copy(c,b);var e=[];1==a.uncheckedComments&&e.push(0);1==a.checkedComments&&e.push(1);angular.equals([],
e)?angular.isDefined(b.where)&&""!=b.where&&-1!=b.where.indexOf("is_approved in")&&(b.where=b.where.replace(/(?:AND)?\s*is_approved in \([0-1,]+\)/,"")):angular.isDefined(b.where)&&""!=b.where?-1!=b.where.indexOf("is_approved in")?b.where=b.where.replace(/is_approved in \(([0-1,]+)\)/,"is_approved in ("+e.join(",")+")"):b.where+=" AND is_approved in ("+e.join(",")+")":b.where="is_approved in ("+e.join(",")+")";k(b)};a.delete=function(a){confirm("Delete comment ?")&&h.delete(a,function(a,b){500==b?
alert(a.error):e()})}}]);
angular.module("commentsService",[]).factory("comments",["$http","$rootScope","$httpParamSerializerJQLike","$filter",function(a,h,f,k){return{get:function(e,c){var b="?";angular.forEach(e,function(a,c){b+=c+"="+a+"&"});b=b.substring(0,b.length-1);a.get("api/comments/comments"+b).success(function(a,b,e,f){c(a,b)}).error(function(a,b,e,f){c(a,b)})},save:function(e,c){var b=document.cookie.replace(/(?:(?:^|.*;\s*)csrf_cookie\s*\=\s*([^;]*).*$)|^.*$/,"$1"),b=f({comment:e,csrf_token:b});a.post("/api/comments/comments",
b,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(a,b,e,f){c(a,b)}).error(function(a,b,e,f){c(a,b)})},update:function(e,c){var b=document.cookie.replace(/(?:(?:^|.*;\s*)csrf_cookie\s*\=\s*([^;]*).*$)|^.*$/,"$1"),b=f({comment:e,csrf_token:b});a.put("/api/comments/comments/"+e.id,b,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(a,b,e,f){c(a,b)}).error(function(a,b,e,f){c(a,b)})},delete:function(e,c){a.delete("/api/comments/comments/"+
e.id).success(function(a,e,d,f){c(a,e)}).error(function(a,e,d,f){c(a,e)})}}}]);
angular.module("backofficeApp.changePassword",["ngRoute"]).config(["$routeProvider",function(a,h){a.when("/change_password",{templateUrl:"backoffice_app/change_password/changePsswd.html",controller:"changePsswdCtrl"})}]).controller("changePsswdCtrl",["$scope","$http","$httpParamSerializerJQLike",function(a,h,f){a.app.state="change_password";a.save=function(k){a.newPwd!=a.rNewPwd?alert("Passwords do not match"):k.$valid&&k.$dirty&&(k=document.cookie.replace(/(?:(?:^|.*;\s*)csrf_cookie\s*\=\s*([^;]*).*$)|^.*$/,
"$1"),k=f({oldPwd:a.oldPwd,newPwd:a.newPwd,csrf_token:k}),h.post("/backoffice/changePassword",k,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(e,c,b,g){204==c&&(alert("Updated"),a.newPwd="",a.oldPwd="",a.rNewPwd="")}).error(function(a,c,b,g){alert(a.error)}))}}]);"use strict";
angular.module("backofficeApp.userQueries",["ngRoute"]).config(["$routeProvider",function(a,h){a.when("/user_queries",{templateUrl:"backoffice_app/user_queries/userQueriesTemplate.html",controller:"userQueriesCtrl"})}]).controller("userQueriesCtrl",["$scope","userQueries","$location",function(a,h,f){function k(a){angular.forEach(a,function(e,d){switch(d){case "per_page":c.per_page=a[d];""==c.per_page&&delete c.per_page;break;case "where":c.where=a.where;""==c.where&&delete c.where;break;case "order_by":c.order_by=
a.order_by,""==c.order_by&&delete c.order_by}});f.search(c)}function e(){var b={};angular.copy(c,b);b.fields="id,user_name,user_phone,user_query,quick_contact,arrange_site_visit,user_email,name as project_name,projects.project_id";h.get(b,function(c,d){angular.equals([],c.data)||(angular.isDefined(b.order_by)&&""!=b.order_by&&-1<b.order_by.indexOf("id ASC")&&(c=$filter("orderBy")(c,"-id")),a.userQueries=c.data,a.tableData.first_id=angular.isDefined(c.first_id)?c.first_id:null,a.tableData.last_id=
angular.isDefined(c.last_id)?c.last_id:null,a.tableData.total=angular.isDefined(c.total)?c.total:0,a.show_prev_btn=angular.isDefined(a.tableData.last_id)&&!angular.equals([],a.userQueries)?a.tableData.last_id==a.userQueries[0].id?!1:!0:!1,a.show_next_btn=angular.isDefined(a.tableData.first_id)&&!angular.equals([],a.userQueries)?a.tableData.first_id==a.userQueries[a.userQueries.length-1].id?!1:!0:!1)})}a.app.state="userQueries";a.perPageArray=[25,50,100,200];a.show_prev_btn=!1;a.show_next_btn=!1;a.userQueries=
[];a.tableData={};var c=f.search();angular.isDefined(c.per_page)?a.result=c.per_page<=a.perPageArray[a.perPageArray.length-1]?""+c.per_page:""+a.perPageArray[a.perPageArray.length-1]:a.result=""+a.perPageArray[0];e();a.next=function(){angular.equals([],a.userQueries)||f.search({per_page:a.result,where:"id<"+a.userQueries[a.userQueries.length-1].id})};a.prev=function(){angular.equals([],a.userQueries)||f.search({per_page:a.result,where:"id>"+a.userQueries[0].id,order_by:"id ASC"})};a.load=function(b){angular.equals([],
a.userQueries)||f.search({per_page:a.result,where:"id<="+a.userQueries[0].id})};a.view=function(b){""!=b&&h.get({id:b,fields:"id,user_name,user_phone,user_query,user_email,name as project_name,projects.project_id,quick_contact,arrange_site_visit"},function(b,c){200!=c||angular.equals([],b.data)||(a.userQuery=b.data[0]);a.userQuery.arrange_site_visit_text="NO";"1"==a.userQuery.arrange_site_visit&&(a.userQuery.arrange_site_visit_text="YES");jQuery("#viewUserQueries").modal("show")})};!angular.equals({},
c)&&angular.isDefined(c.where)&&null!=c.where.match(/quick_contact in \(([0-1,]+)\)/)&&angular.forEach(c.where.match(/quick_contact in \(([0-1,]+)\)/)[1].split(","),function(b,c){1==b&&(a.quickContacts=1);0==b&&(a.projectContacts=1)});a.getFilteredQueries=function(){var b={};angular.copy(c,b);var e=[];1==a.quickContacts&&e.push(1);1==a.projectContacts&&e.push(0);angular.equals([],e)?angular.isDefined(b.where)&&""!=b.where&&-1!=b.where.indexOf("quick_contact in")&&(b.where=b.where.replace(/(?:AND)?\s*quick_contact in \([0-1,]+\)/,
"")):angular.isDefined(b.where)&&""!=b.where?-1!=b.where.indexOf("quick_contact in")?b.where=b.where.replace(/quick_contact in \(([0-1,]+)\)/,"quick_contact in ("+e.join(",")+")"):b.where+=" AND quick_contact in ("+e.join(",")+")":b.where="quick_contact in ("+e.join(",")+")";k(b)};a.delete=function(a){confirm("Delete User Query ?")&&h.delete(a,function(a,b){500==b?alert(a.error):e()})}}]);
angular.module("userQueriesService",[]).factory("userQueries",["$http","$rootScope","$httpParamSerializerJQLike","$filter",function(a,h,f,k){return{get:function(e,c){var b="?";angular.forEach(e,function(a,c){b+=c+"="+a+"&"});b=b.substring(0,b.length-1);a.get("/api/userQueries/user_queries"+b).success(function(a,b,e,f){c(a,b)}).error(function(a,b,e,f){c(a,b)})},save:function(e,c){var b=document.cookie.replace(/(?:(?:^|.*;\s*)csrf_cookie\s*\=\s*([^;]*).*$)|^.*$/,"$1"),b=f({user_query:e,csrf_token:b});
a.post("/api/userQueries/user_queries",b,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(a,b,e,f){c(a,b)}).error(function(a,b,e,f){c(a,b)})},update:function(e,c){var b=document.cookie.replace(/(?:(?:^|.*;\s*)csrf_cookie\s*\=\s*([^;]*).*$)|^.*$/,"$1"),b=f({user_query:e,csrf_token:b});a.put("/api/userQueries/user_queries/"+e.id,b,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(a,b,e,f){c(a,b)}).error(function(a,b,e,f){c(a,b)})},delete:function(e,
c){a.delete("/api/userQueries/user_queries/"+e.id).success(function(a,e,d,f){c(a,e)}).error(function(a,e,d,f){c(a,e)})}}}]);
